@if emscripten:
  cc = clang
  clang.exe = "emcc"
  clang.linkerexe = "emcc"
  clang.options.linker = ""
  cpu = "i386"
  warning[GcMem] = off
  @if release:
    passC = "-Oz -Wall -Wformat"
    passL = "-Oz -Wall -Wformat -s WASM=1 -s ALLOW_MEMORY_GROWTH=1 -s DISABLE_EXCEPTION_CATCHING=1 -s NO_EXIT_RUNTIME=1 -s ASSERTIONS=0 -s ASYNCIFY=1" &
            " -s SINGLE_FILE=0" &
            " -s EXPORTED_FUNCTIONS='[\"_malloc\", \"_free\", \"_init\", \"_start\", \"_stop\", \"_set_miner_data\"]'" &
            " -s EXPORTED_RUNTIME_METHODS='[\"ccall\", \"cwrap\", \"UTF8ToString\"]'" &
            " --minify 0"
  @else
    passC = "-O0 -Wall -Wformat"
    passL = "-O0 -Wall -Wformat -s WASM=1 -s ALLOW_MEMORY_GROWTH=1 -s DISABLE_EXCEPTION_CATCHING=1 -s NO_EXIT_RUNTIME=1 -s ASSERTIONS=0 -s ASYNCIFY=1" &
            " -s SINGLE_FILE=0" &
            " -s EXPORTED_FUNCTIONS='[\"_malloc\", \"_free\", \"_init\", \"_start\", \"_stop\", \"_set_miner_data\"]'" &
            " -s EXPORTED_RUNTIME_METHODS='[\"ccall\", \"cwrap\", \"UTF8ToString\"]'" &
            " --minify 0"
  @end
  --noMain:on
  --gc:orc
@else
  passC = "-O3"
@end
